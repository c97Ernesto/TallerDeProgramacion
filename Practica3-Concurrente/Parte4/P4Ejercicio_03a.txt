programa P4Ejercicio_03

procesos
  proceso juntarPapeles(ES papeles: numero)
  comenzar
    mientras HayPapelEnLaEsquina
      tomarPapel
      papeles:= papeles + 1
  fin

  proceso concluirEtapa(E miId: numero)
  variables
    unId, otroId: numero
  comenzar
    si (miId = 1)
      EnviarMensaje(miId, r2)
      EnviarMensaje(miId, r3)
    sino
      si (miId = 2)
        EnviarMensaje(miId, r1)
        EnviarMensaje(miId, r3)
      sino
        EnviarMensaje(miId, r1)
        EnviarMensaje(miId, r2)
    RecibirMensaje(unId, *)
    RecibirMensaje(otroId, *)
  fin


areas
  areaR1: AreaP(1, 1, 1, 100)
  areaR2: AreaP(2, 1, 2, 100)
  areaR3: AreaP(3, 1, 3, 100)
  areaRx: AreaP(4,1,4,1)


robots
  robot r
  variables
    papeles: numero
    id: numero
  comenzar
    papeles:= 0
    RecibirMensaje(id, rX)
    repetir 19
      repetir 5
        juntarPapeles(papeles)
        mover
      concluirEtapa(id)
    repetir 4
      juntarPapeles(papeles)
      mover
    juntarPapeles(papeles)
    concluirEtapa(id)
  fin

  robot x
  comenzar
    EnviarMensaje(1, r1)
    EnviarMensaje(2, r2)
    EnviarMensaje(3, r3)
  fin


variables
  r1: r
  r2: r
  r3: r
  rX: x

comenzar
  AsignarArea(r1, areaR1)
  AsignarArea(r2, areaR2)
  AsignarArea(r3, areaR3)
  AsignarArea(rX, areaRx)
  Iniciar(r1, 1, 1)
  Iniciar(r2, 2, 1)
  Iniciar(r3, 3, 1)
  Iniciar(rX, 4, 1)
fin